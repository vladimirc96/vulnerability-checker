import React, { Component } from 'react';
import vulnerabilityService from '../../service/VulnerabilityService'; 

class RepositoryStatisticTable extends Component {
    
    constructor(props) {
        super();
        this.state = {
            data: []
        }
    }

    componentDidMount() {
        vulnerabilityService.findAllByRepositoryId(this.props.repoId).then(
            (data) => {
                this.setState({data: data});
            }
        ).catch(error => alert(error));    
    }

    render() {
        let statistic = [];

        if(this.state.data != undefined){
            statistic = this.state.data.map(
                item => {
                    return (
                    <tr key={item.cveId}> <td>{item.name}</td> <td>{item.severityV3}</td> <td>{item.severityV2}</td> <td> <a href={item.infoUrl} target="_blank">{item.infoUrl}</a></td>  </tr>
                    )
                }
            )
        }

        return(
            <div>
                    <div className="table-wrapper-scroll-y my-custom-scrollbar">
                    <table className="table table-bordered table-striped mb-0">
                        <thead>
                        <tr>
                            <th scope="col">Name</th>
                            <th scope="col">Severity V3</th>
                            <th scope="col">Severity V2</th>
                            <th scope="col">Info url</th>
                        </tr>
                        </thead>
                        <tbody>
                                { statistic }
                        </tbody>
                    </table>
                </div>
            </div>
           
        )
    }
}

export default RepositoryStatisticTable;