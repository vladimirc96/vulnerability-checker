import React, { Component } from 'react';
import repositoryService from '../../service/RepositoryService';

class StatisticTable extends Component {

    constructor(){
        super();
        this.state = { list: [] }
    }

    componentDidMount(){
        repositoryService.findAllOrderByOwnerName().then(
            (statistic) => {
                this.setState({list: statistic});
            }
        ).catch(error => alert(error));
    }

    render(){
        let statistic = [];

        if(this.state.list != undefined){
            statistic = this.state.list.map(
                item => {
                    return (
                    <tr key={item.repositoryDTO.id}> <td>{item.repositoryDTO.ownerName}</td> <td>{item.repositoryDTO.name}</td> <td>{item.repoVulns}</td> <td>{item.totalVulns}</td> </tr>
                    )
                }
            )
        }

        return(
            <div>
                <h2>Repositories</h2>
                {
                    this.state.list.length != 0 ? 
                    <div class="table-wrapper-scroll-y">
                    <table class="table table-bordered table-striped mb-0">
                        <thead>
                        <tr>
                            <th scope="col">Owner name</th>
                            <th scope="col">Repository name</th>
                            <th scope="col">Number of vulns</th>
                            <th scope="col">Total vulns</th>
                        </tr>
                        </thead>
                        <tbody>
                                { statistic }
                        </tbody>
                    </table>
                </div>
                :
                <h3>No data.</h3>
                }
            </div>
           
        )
    }

}

export default StatisticTable;