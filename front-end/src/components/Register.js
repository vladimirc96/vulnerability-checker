import React, { Component } from 'react';
import {Link, Redirect, useHistory} from 'react-router-dom';
import backendApi from '../apis/BackendApi';
import { Formik, Field, Form, ErrorMessage } from 'formik';
import * as Yup from 'yup';

class Register extends Component {

    state = {
    }

    constructor(){
        super();
    }

    handleSubmit = (fields) => {
        const data = {
            firstName: fields.firstName,
            lastName: fields.lastName,
            email: fields.email,
            username: fields.username,
            password: fields.password
        }
        backendApi.post('/user/register', data)
            .then(response => {
                alert("Registration successfull");
                window.location = "http://localhost:3000"
            })
            .catch(error => {
                alert(error)
            })
    }

    handleInputChange = (event) => {
        this.setState({
            [event.target.name]: event.target.value
        })
    }

    render(){

        return(
            <div class="wrapper" style={{background: "#2C54C6",
                                        height: "100%",
                                        width:"100%"}}>

                    <div class="row justify-content-center">
                        <div class="col-md-5">
                        <div class="card o-hidden border-0 shadow-lg my-5">
                            <div class="card-body p-0">
                                        <div class="p-5">
                                            <div class="text-center">
                                                <h1 class="h4 text-gray-900 mb-4">Create an Account!</h1>
                                            </div>
                                            
                                            <Formik
                                                initialValues={{
                                                    firstName: '',
                                                    lastName: '',
                                                    email: '',
                                                    username: '',
                                                    password: '',
                                                }}
                                                validationSchema={Yup.object().shape({
                                                    firstName: Yup.string()
                                                        .required('First Name is required'),
                                                    lastName: Yup.string()
                                                        .required('Last Name is required'),
                                                    email: Yup.string()
                                                        .email('Email is invalid')  
                                                        .required('Email is required'),
                                                    username: Yup.string()
                                                        .required('Username is required'),
                                                    password: Yup.string()
                                                        .required('Password is required'),
                                                })}
                                                onSubmit={fields => this.handleSubmit(fields)}
                                                render={({ errors, status, touched }) => (
                                                    <Form>
                                                        <form class="user">
                                                                <div class="form-group row">
                                                                <div class="col-sm-6 mb-3 mb-sm-0">
                                                                    <Field type="text"
                                                                        name="firstName"
                                                                        className={'form-control form-control-user' + (errors.firstName && touched.firstName ? ' is-invalid' : '')}
                                                                        placeholder="First Name"/>
                                                                     <ErrorMessage name="firstName" component="div" className="invalid-feedback" />
                                                                </div>

                                                                <div class="col-sm-6">
                                                                    <Field type="text"
                                                                        name="lastName"
                                                                        className={'form-control form-control-user' + (errors.lastName && touched.lastName ? ' is-invalid' : '')}
                                                                        placeholder="Last Name"/>
                                                                     <ErrorMessage name="lastName" component="div" className="invalid-feedback" />
                                                                </div>
                                                                </div>
                                                                
                                                                <div class="form-group">
                                                                    <Field type="text"
                                                                        name="email"
                                                                        className={'form-control form-control-user' + (errors.email && touched.email ? ' is-invalid' : '')}
                                                                        placeholder="Email Address"/>
                                                                    <ErrorMessage name="email" component="div" className="invalid-feedback" />
                                                                </div>
                                                                
                                                                <div class="form-group row">
                                                                <div class="col-sm-6 mb-3 mb-sm-0">
                                                                    <Field type="text"
                                                                        name="username"
                                                                        className={'form-control form-control-user' + (errors.username && touched.username ? ' is-invalid' : '')}
                                                                        placeholder="Username"/>
                                                                     <ErrorMessage name="username" component="div" className="invalid-feedback" />
                                                                </div>
                                                                
                                                                <div class="col-sm-6">
                                                                    <Field type="password"
                                                                        name="password"
                                                                        className={'form-control form-control-user' + (errors.password && touched.password ? ' is-invalid' : '')}
                                                                        placeholder="Password"/>
                                                                     <ErrorMessage name="password" component="div" className="invalid-feedback" />
                                                                </div>
                                                                </div>
                                                                
                                                                <button type="submit" class="btn btn-primary btn-user btn-block">
                                                                    Register Account
                                                                </button>
                                                                <hr/>
                                                            </form>
                                                    </Form>
                                                )}
                                            />
                                            <hr />
                                            <div class="text-center">
                                                <Link to="/login">
                                                    <a class="small">Already have an account? Login!</a>
                                                </Link>
                                            </div>
                                            </div>
                                                </div>
                                        </div>
                                    </div>
                    </div>
            </div>


        )


    }


}

export default Register