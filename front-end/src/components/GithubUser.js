import React, {Component} from 'react';
import GithubUserList from './GithubUserList';
import GithubUserForm from './forms/GithubUserForm';
import githubUserService from '../service/GithubUserService';

class GithubUser extends Component {

    constructor(){
        super();
        this.state = {
            githubUsers: []
        }
    }

    register  = (user) => {
        this.setState(prevState => {
            let prevGithubUsers = prevState.githubUsers;
            prevGithubUsers.push(user);
            return { 
                githubUsers: prevGithubUsers
            }
        });
        
    }

    componentDidMount(){
        githubUserService.findAll().then(
            (users) => {
                this.setState({githubUsers: users});
            }
        ).catch(error => alert(error));
    }
    
    render(){
        return(
            <div>
                <div>
                    <GithubUserForm register={this.register}/>
                </div>
                <div>
                    <GithubUserList githubUsers={this.state.githubUsers}/>
                </div>
            </div>
        )
        
    }
}

export default GithubUser;