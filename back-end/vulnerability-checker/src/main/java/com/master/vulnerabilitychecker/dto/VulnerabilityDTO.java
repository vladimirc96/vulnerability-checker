package com.master.vulnerabilitychecker.dto;

import com.master.vulnerabilitychecker.model.Repository;

import java.util.ArrayList;
import java.util.List;

public class VulnerabilityDTO {

    private String cveId;
    private String name;
    private String description;
    private List<String> references = new ArrayList<>();
    private String infoUrl;
    private RepositoryDTO repositoryDTO;

    public VulnerabilityDTO() {
    }

    public VulnerabilityDTO(String cveId, String name, String description, String references) {
        this.cveId = cveId;
        this.name = name;
        this.description = description;
        this.setReferences(references);
        this.infoUrl = "https://nvd.nist.gov/vuln/detail/" + cveId;
    }

    public VulnerabilityDTO(String cveId, String name, String description, String references, Repository repository) {
        this.cveId = cveId;
        this.name = name;
        this.description = description;
        this.setReferences(references);
        this.infoUrl = "https://nvd.nist.gov/vuln/detail/" + cveId;
        this.repositoryDTO = new RepositoryDTO(repository.getId(), repository.getName(), repository.getUrl(), repository.getOwnerName());
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getCveId() {
        return cveId;
    }

    public void setCveId(String cveId) {
        this.cveId = cveId;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public List<String> getReferences() {
        return references;
    }

    public void setReferences(String references) {
        String[] refs = references.split(",");
        for(int i = 0; i < refs.length; i++){
            if(refs[i] != null){
                this.references.add(refs[i]);
            }
        }
    }

    public String getInfoUrl() {
        return infoUrl;
    }

    public void setInfoUrl(String infoUrl) {
        this.infoUrl = infoUrl;
    }

    public RepositoryDTO getRepositoryDTO() {
        return repositoryDTO;
    }

    public void setRepositoryDTO(RepositoryDTO repositoryDTO) {
        this.repositoryDTO = repositoryDTO;
    }
}
