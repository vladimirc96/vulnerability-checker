package com.master.vulnerabilitychecker.service;

import com.master.vulnerabilitychecker.model.User;
import org.eclipse.egit.github.core.client.GitHubClient;
import org.kohsuke.github.GitHub;
import org.springframework.stereotype.Service;

import java.io.IOException;

@Service
public class GithubAPIService {

    private CryptoService cryptoService;

    public GithubAPIService(CryptoService cryptoService) {
        this.cryptoService = cryptoService;
    }

    public GitHubClient connect(User user) {
        GitHubClient client = new GitHubClient();
        client.setOAuth2Token(cryptoService.decrypt(user.getAccessToken()));
        return client;
    }
}
