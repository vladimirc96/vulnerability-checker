package com.master.vulnerabilitychecker.model;

import com.fasterxml.jackson.annotation.JsonIgnore;

import javax.persistence.*;
import java.util.List;

@Entity
@Table(name= "vulnerability")
public class Vulnerability {

    @Id
    @Column(name = "id")
    private String cveId;

    @Column(name = "name")
    private String name;

    @Lob
    private String description;

    @Lob
    private String referenceUrls;

    @Column(name = "info_url")
    private String infoUrl;

    @JsonIgnore
    @ManyToOne
    private Repository repository;

    public Vulnerability() {

    }

    public Vulnerability(String cveId, String name, String description, List<String> referenceUrls, String infoUrl) {
        this.cveId = cveId;
        this.name = name;
        this.description = description;
        this.setReferenceUrls(referenceUrls);
        this.infoUrl = infoUrl;
    }

    public String getCveId() {
        return cveId;
    }

    public void setCveId(String id) {
        this.cveId = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getReferenceUrls() {
        return referenceUrls;
    }

    public void setReferenceUrls(List<String> references) {
        for(String ref: references){
            if(ref != null){
                this.referenceUrls += "," + ref;
            }
        }
    }

    public String getInfoUrl() {
        return infoUrl;
    }

    public void setInfoUrl(String infoUrl) {
        this.infoUrl = infoUrl;
    }

    public Repository getRepository() {
        return repository;
    }

    public void setRepository(Repository repository) {
        this.repository = repository;
    }
}
