package com.master.vulnerabilitychecker.model.builder;

import com.fasterxml.jackson.annotation.JsonIgnore;
import com.master.vulnerabilitychecker.model.Repository;
import com.master.vulnerabilitychecker.model.Vulnerability;

import javax.persistence.Column;
import javax.persistence.Id;
import javax.persistence.Lob;
import javax.persistence.ManyToOne;
import java.util.List;

public final class VulnerabilityBuilder {

    private String cveId;
    private String name;
    private String description;
    private List<String> referenceUrls;
    private String infoUrl;
    private String severityV2;
    private String severityV3;

    public VulnerabilityBuilder cveId(String cveId) {
        this.cveId = cveId;
        return this;
    }

    public VulnerabilityBuilder name(String name) {
        this.name = name;
        return this;
    }

    public VulnerabilityBuilder description(String description) {
        this.description = description;
        return this;
    }

    public VulnerabilityBuilder referenceUrls(List<String> referenceUrls) {
        this.referenceUrls = referenceUrls;
        return this;
    }

    public VulnerabilityBuilder infoUrl(String cveId) {
        this.infoUrl = "https://nvd.nist.gov/vuln/detail/" + cveId;
        return this;
    }

    public VulnerabilityBuilder severityV2(String severityV2) {
        this.severityV2 = severityV2;
        return this;
    }

    public VulnerabilityBuilder severityV3(String severityV3) {
        this.severityV3 = severityV3;
        return this;
    }

    public Vulnerability build(){
        return new Vulnerability(this);
    }

    public String getCveId() {
        return cveId;
    }

    public String getName() {
        return name;
    }

    public String getDescription() {
        return description;
    }

    public List<String> getReferenceUrls() {
        return referenceUrls;
    }

    public String getInfoUrl() {
        return infoUrl;
    }

    public String getSeverityV2() {
        return severityV2;
    }

    public String getSeverityV3() {
        return severityV3;
    }

}
